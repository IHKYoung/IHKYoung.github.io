<!DOCTYPE html>














<script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            processEscapes: true,
            processEnvironments: true
        },
        options: {
            skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
        }
    };

    window.addEventListener('load', (event) => {
        document.querySelectorAll("mjx-container").forEach(function (x) {
            x.parentElement.classList += 'has-jax'
        })
    });
</script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>



<html lang="zh" dir="zh-cn">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Linuxï¼šä¸Šä¸äº†ç½‘äº†ä¹‹è·¯ç”±è¡¨ä¿®å¤ | AhaKnow</title>
<meta name="keywords" content="è·¯ç”±è¡¨">
<meta name="description" content="è¿æ¥ä¸€ä¸ªç½‘å£è®¾å¤‡ï¼Œå¯¼è‡´ä¸Šä¸äº†ç½‘ï¼Œå’‹æ€ï¼Ÿ">
<meta name="author" content="CKYoung">
<link rel="canonical" href="https://ahaknow.com/posts/know/linux-repair-routing-table/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://ahaknow.com/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://ahaknow.com/Q.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://ahaknow.com/Q.gif">
<link rel="apple-touch-icon" href="https://ahaknow.com/Q.gif">
<link rel="mask-icon" href="https://ahaknow.com/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://ahaknow.com/posts/know/linux-repair-routing-table/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Linuxï¼šä¸Šä¸äº†ç½‘äº†ä¹‹è·¯ç”±è¡¨ä¿®å¤" />
<meta property="og:description" content="è¿æ¥ä¸€ä¸ªç½‘å£è®¾å¤‡ï¼Œå¯¼è‡´ä¸Šä¸äº†ç½‘ï¼Œå’‹æ€ï¼Ÿ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ahaknow.com/posts/know/linux-repair-routing-table/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-04-16T11:04:42+08:00" />
<meta property="article:modified_time" content="2024-04-16T11:04:42+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Linuxï¼šä¸Šä¸äº†ç½‘äº†ä¹‹è·¯ç”±è¡¨ä¿®å¤"/>
<meta name="twitter:description" content="è¿æ¥ä¸€ä¸ªç½‘å£è®¾å¤‡ï¼Œå¯¼è‡´ä¸Šä¸äº†ç½‘ï¼Œå’‹æ€ï¼Ÿ"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ğŸš€ å¤©å¤©å‘ä¸Š",
      "item": "https://ahaknow.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸŒŸçŸ¥è¯†",
      "item": "https://ahaknow.com/posts/know/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Linuxï¼šä¸Šä¸äº†ç½‘äº†ä¹‹è·¯ç”±è¡¨ä¿®å¤",
      "item": "https://ahaknow.com/posts/know/linux-repair-routing-table/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Linuxï¼šä¸Šä¸äº†ç½‘äº†ä¹‹è·¯ç”±è¡¨ä¿®å¤",
  "name": "Linuxï¼šä¸Šä¸äº†ç½‘äº†ä¹‹è·¯ç”±è¡¨ä¿®å¤",
  "description": "è¿æ¥ä¸€ä¸ªç½‘å£è®¾å¤‡ï¼Œå¯¼è‡´ä¸Šä¸äº†ç½‘ï¼Œå’‹æ€ï¼Ÿ",
  "keywords": [
    "è·¯ç”±è¡¨"
  ],
  "articleBody": " é—®é¢˜æè¿°ï¼š\nLinuxåŒæ—¶è¿æ¥å±€åŸŸç½‘ï¼Œç½‘æ®µæ˜¯172.27.0.xï¼Œä»¥åŠè¿æ¥ç½‘å£çš„ç›¸æœºè®¾å¤‡ï¼Œç½‘æ®µæ˜¯192.168.80.xã€‚\nLinuxå¯åŠ¨åå‡ºç°è¿™ç§æƒ…å†µï¼š\nå¯ä»¥è¿æ¥ç›¸æœºï¼Œä½†æ— æ³•ä¸Šç½‘ å°†ç›¸æœºçš„ç½‘çº¿æ‹”æ‰åï¼Œå°±èƒ½å¤Ÿä¸Šç½‘äº† ç®€å•çš„åˆ†æä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯ç½‘ç»œå ç”¨çš„é—®é¢˜ã€‚\nå…ˆæŠŠé—®é¢˜è§£å†³äº† ä¸‹é¢å…·ä½“æ¥åˆ†æ\né€šè¿‡route -næ¥æŸ¥çœ‹è·¯ç”±è¡¨ä¿¡æ¯ï¼š\nâ¯ route -n Kernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface 0.0.0.0 192.168.80.1 0.0.0.0 UG 0 0 0 eno1 0.0.0.0 172.27.0.1 0.0.0.0 UG 101 0 0 eno1 169.254.0.0 0.0.0.0 255.255.0.0 U 1000 0 0 enx0826ae3c0c7b 172.17.0.0 0.0.0.0 255.255.0.0 U 0 0 0 docker0 172.27.0.0 0.0.0.0 255.255.255.0 U 101 0 0 eno1 192.168.80.0 0.0.0.0 255.255.255.0 U 100 0 0 enx0826ae3c0c7b å¯ä»¥çœ‹å‡ºæ¥æœ‰ä¸¤ä¸ªè®¾å¤‡ï¼Œä¸€ä¸ªæ˜¯eno1ï¼Œå±€åŸŸç½‘ç½‘çº¿ï¼Œå¦ä¸€ä¸ªæ˜¯enx0826ae3c0c7bï¼Œç½‘å£çš„ç›¸æœºã€‚\nä¸ºå•¥ä¼šä¸Šä¸äº†ç½‘æï¼Ÿ\nè§‚å¯Ÿè¿™ä¸ªè·¯ç”±è¡¨çš„å¯ä»¥å‘ç°æœ‰ä¸€ä¸ªé‡å¤çš„æ··ä¹±é¡¹ï¼š\nDestination ä¸º 0.0.0.0 ä½†æ˜¯ Gateway å´æœ‰ä¸¤ä¸ªï¼Œå°±æ˜¯è¿™é‡Œå¯¼è‡´çš„ï¼Œè¿™æ—¶å€™çš„è§£å†³æ–¹æ³•å°±æ˜¯ï¼Œå…ˆæ¸…é™¤é»˜è®¤è·¯ç”±ï¼Œç„¶åå†é…ç½®ä¸€ä¸ªæ­£ç¡®çš„é»˜è®¤è·¯ç”±ã€‚\næ­¥éª¤1ï¼šæ¸…é™¤é”™è¯¯çš„é»˜è®¤è·¯ç”±\né¦–å…ˆï¼Œåˆ é™¤æ‰€æœ‰é»˜è®¤è·¯ç”±ï¼š\nsudo ip route del default æ­¥éª¤2ï¼šæ·»åŠ æ­£ç¡®çš„é»˜è®¤è·¯ç”±\nå°†é»˜è®¤è·¯ç”±è®¾ç½®ä¸ºé€šè¿‡ç½‘å…³`172.27.0.1ï¼Œå¹¶æŒ‡å®šåˆé€‚çš„åº¦é‡å€¼ï¼š\nsudo ip route add default via 172.27.0.1 dev eno1 metric 0 æ­¥éª¤3ï¼šéªŒè¯è·¯ç”±è¡¨\nå†æ¬¡æ£€æŸ¥è·¯ç”±è¡¨ï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œå¹¶ä¸”å…¶ä»–è·¯ç”±æŒ‰é¢„æœŸé…ç½®ï¼š\nroute -n è¿™ä¸ªæ—¶å€™å¾—åˆ°çš„åº”è¯¥å°±æ˜¯æ­£ç¡®çš„è·¯ç”±è¡¨äº†ï¼š\nâ¯ route -n Kernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface 0.0.0.0 172.27.0.1 0.0.0.0 UG 0 0 0 eno1 0.0.0.0 172.27.0.1 0.0.0.0 UG 101 0 0 eno1 169.254.0.0 0.0.0.0 255.255.0.0 U 1000 0 0 enx0826ae3c0c7b 172.17.0.0 0.0.0.0 255.255.0.0 U 0 0 0 docker0 172.27.0.0 0.0.0.0 255.255.255.0 U 101 0 0 eno1 192.168.80.0 0.0.0.0 255.255.255.0 U 100 0 0 enx0826ae3c0c7b å¦ä¸€ç§æ€è·¯ åœ¨è·¯ç”±è¡¨ä¸­ï¼Œmetricå€¼ç”¨äºå®šä¹‰è·¯ç”±çš„ä¼˜å…ˆçº§ã€‚å½“å­˜åœ¨å¤šæ¡åˆ°è¾¾åŒä¸€ä¸ªç›®çš„åœ°çš„è·¯ç”±æ—¶ï¼Œmetricå€¼è¾ƒå°çš„è·¯ç”±å°†è¢«ä¼˜å…ˆé€‰æ‹©ç”¨äºæ•°æ®ä¼ è¾“ã€‚å› æ­¤ï¼Œmetricæ˜¯ä¸€ç§å†³å®šè·¯å¾„é€‰æ‹©çš„æ–¹æ³•ï¼Œå°¤å…¶åœ¨å¤šä¸ªç½‘ç»œæ¥å£å¯ç”¨æ—¶è¿™ä¸€ç‚¹éå¸¸é‡è¦ã€‚\nMetric çš„å«ä¹‰å’Œä½œç”¨ å«ä¹‰ï¼šmetricå€¼æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œç”¨äºè¡¨ç¤ºè·¯ç”±çš„ä¼˜å…ˆçº§ã€‚æ•°å­—è¶Šå°ï¼Œè¯¥è·¯ç”±çš„ä¼˜å…ˆçº§è¶Šé«˜ã€‚ ä½œç”¨ï¼š é€‰æ‹©æœ€ä¼˜è·¯å¾„ï¼šåœ¨å¤šæ¡è·¯ç”±å¯è¾¾åŒä¸€ç›®çš„åœ°çš„æƒ…å†µä¸‹ï¼Œè·¯ç”±å™¨æ ¹æ®metricå€¼é€‰æ‹©metricæœ€å°çš„è·¯ç”±ä½œä¸ºæœ€ä½³è·¯å¾„ã€‚ è´Ÿè½½å‡è¡¡ï¼šåœ¨æŸäº›é…ç½®ä¸­ï¼Œå¯ä»¥æ•…æ„è®¾ç½®ç›¸åŒçš„metricå€¼ç»™ä¸åŒçš„è·¯ç”±ï¼Œä»¥å®ç°è´Ÿè½½å‡è¡¡ã€‚ é¿å…è·¯ç”±å¾ªç¯ï¼šé€‚å½“çš„metricå€¼é…ç½®å¯ä»¥å¸®åŠ©é¿å…è·¯ç”±å¾ªç¯ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤æ‚çš„ç½‘ç»œæ‹“æ‰‘ä¸­ã€‚ Metric å€¼çš„é€‰æ‹© æ¯”å¦‚ï¼Œmetricå€¼ä¸º0, 101, 100, 1000ç­‰ï¼Œè¿™äº›éƒ½æ˜¯ç”¨æ¥åŒºåˆ†ä¸åŒè·¯ç”±æ¡ç›®çš„ç›¸å¯¹ä¼˜å…ˆçº§ã€‚ä¾‹å¦‚ï¼š\nMetric ä¸º 0ï¼šé€šå¸¸è¡¨ç¤ºè¯¥è·¯ç”±å…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œç³»ç»Ÿå°†ä¼˜å…ˆé€šè¿‡è¿™ä¸ªè·¯ç”±å‘é€æ•°æ®ã€‚ Metric ä¸º 101 æˆ– 100ï¼šè¿™äº›å€¼è¾ƒé«˜ï¼Œè¡¨ç¤ºè·¯ç”±çš„ä¼˜å…ˆçº§è¾ƒä½ã€‚å¦‚æœé»˜è®¤è·¯ç”±ï¼ˆmetric ä¸º 0 çš„è·¯ç”±ï¼‰ä¸å¯ç”¨ï¼Œç³»ç»Ÿå¯èƒ½ä¼šè€ƒè™‘ä½¿ç”¨è¿™äº›è·¯ç”±ã€‚ Metric ä¸º 1000ï¼šæ›´é«˜çš„metricå€¼ï¼Œé€šå¸¸ç”¨äºå¤‡ä»½è·¯ç”±ï¼Œåªæœ‰åœ¨å…¶ä»–è¾ƒä½metricå€¼çš„è·¯ç”±å…¨éƒ½ä¸å¯ç”¨æ—¶ï¼Œæ‰ä¼šè¢«ä½¿ç”¨ã€‚ å› æ­¤ä¸Šè¿°çš„é—®é¢˜è¿˜å¯ä»¥é€šè¿‡æ›´æ”¹è·¯ç”±çš„ä¼˜å…ˆçº§æ¥è§£å†³\nç°åœ¨é—®é¢˜è§£å†³äº†ï¼Œä½†æ˜¯è§£å†³äº†ä¸€æ—¶ï¼Œè§£å†³ä¸äº†ä¸€ä¸–ï¼Œå¦‚æœLinuxä¸»æœºé‡æ–°å¯åŠ¨ï¼Œé‚£ä¹ˆåˆä¼šæ¢å¤ä¸ºåŸæ¥çš„è®¾ç½®ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ\né‚£å°±è®¾ç½®ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„å¯åŠ¨é¡¹ï¼\nè‡ªåŠ¨åŒ–çš„â€œä¸€åŠ³æ°¸é€¸â€ åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„systemdæœåŠ¡ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´systemdæœåŠ¡æ¥ç¡®ä¿åœ¨æ‰§è¡Œè·¯ç”±åˆ é™¤å’Œæ·»åŠ æ“ä½œä¹‹å‰ï¼Œç½‘ç»œæ¥å£å·²ç»æ­£ç¡®åˆå§‹åŒ–ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥åŠ å…¥æ¡ä»¶åˆ¤æ–­ï¼Œåªåœ¨é»˜è®¤è·¯ç”±å­˜åœ¨æ—¶å°è¯•åˆ é™¤å®ƒã€‚\nä¿®æ”¹ Systemd æœåŠ¡æ–‡ä»¶ï¼š ç¼–è¾‘ä¹‹å‰åˆ›å»ºçš„systemdæœåŠ¡æ–‡ä»¶ï¼Œæ·»åŠ æ¡ä»¶åˆ¤æ–­å’Œä¾èµ–å…³ç³»ï¼Œç¡®ä¿åœ¨æ‰§è¡Œè·¯ç”±æ“ä½œå‰ç½‘ç»œæ¥å£å·²å‡†å¤‡å¥½ã€‚\nsudo vim /etc/systemd/system/setdefaultgateway.service ä¿®æ”¹æœåŠ¡æ–‡ä»¶ï¼ŒåŠ å…¥ç½‘ç»œåœ¨çº¿çš„æ¡ä»¶å’Œæ‰§è¡Œå‘½ä»¤å‰çš„æ£€æŸ¥ï¼š\n[Unit] Description=Set default gateway Wants=network-online.target After=network-online.target [Service] Type=oneshot ExecStartPre=/bin/sh -c 'ip route | grep -q default \u0026\u0026 ip route del default' ExecStart=/sbin/ip route add default via 172.27.0.1 dev eno1 metric 0 RemainAfterExit=yes [Install] WantedBy=multi-user.target è¿™é‡ŒExecStartPreè¡Œç”¨äºæ£€æŸ¥æ˜¯å¦å­˜åœ¨é»˜è®¤è·¯ç”±ï¼Œå¹¶ä¸”åªæœ‰åœ¨å­˜åœ¨çš„æƒ…å†µä¸‹æ‰å°è¯•åˆ é™¤å®ƒã€‚è¿™æ ·å¯ä»¥é¿å…å› ä¸ºå°è¯•åˆ é™¤ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯ç”±è€Œå¯¼è‡´æœåŠ¡å¤±è´¥ã€‚\né‡æ–°åŠ è½½å’Œå¯åŠ¨æœåŠ¡ï¼š åŠ è½½æ–°çš„é…ç½®å¹¶é‡æ–°å¯åŠ¨æœåŠ¡ï¼š\nsudo systemctl daemon-reload sudo systemctl restart setdefaultgateway æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š ç¡®ä¿æœåŠ¡ç°åœ¨èƒ½å¤ŸæˆåŠŸæ‰§è¡Œï¼Œä¸å†æŠ¥é”™ï¼š\nsudo systemctl status setdefaultgateway é€šè¿‡ç¡®ä¿åœ¨ç½‘ç»œæ¥å£å‡†å¤‡å¥½åæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”åªåœ¨é»˜è®¤è·¯ç”±å­˜åœ¨æ—¶å°è¯•åˆ é™¤å®ƒï¼Œèƒ½å¤Ÿé¿å…æœåŠ¡å¯åŠ¨æ—¶é‡åˆ°çš„â€œRTNETLINK answers: No such processâ€é”™è¯¯ã€‚\næœåŠ¡æ–‡ä»¶çš„éƒ¨åˆ†è§£é‡Š [Unit]éƒ¨åˆ†ï¼š Description: ä»…ä¸ºæ­¤æœåŠ¡æä¾›æè¿°ï¼Œè¯´æ˜å…¶ç”¨é€”ã€‚ Wants: è¿™ä¸€è¡ŒæŒ‡å®šäº†æ­¤æœåŠ¡æƒ³è¦çš„å…¶ä»–å•ä½ï¼ˆunitï¼‰ã€‚network-online.targetæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç›®æ ‡ï¼Œä»£è¡¨ç½‘ç»œé…ç½®å·²å®Œå…¨å®Œæˆä¸”äº’è”ç½‘è¿æ¥å·²å»ºç«‹ã€‚ After: è¿™ä¸€è¡Œç¡®ä¿äº†åœ¨network-online.targetä¹‹åæ‰å¯åŠ¨è¿™ä¸ªæœåŠ¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰åœ¨ç½‘ç»œç¡®å®å¯ç”¨ä¹‹åï¼Œæ­¤æœåŠ¡æ‰ä¼šè¿è¡Œå…¶å‘½ä»¤ã€‚ è¿™ä¸¤ä¸ªè®¾ç½®ï¼ˆWantså’ŒAfterï¼‰ç¡®ä¿äº†ç½‘ç»œæœåŠ¡åœ¨å°è¯•ä¿®æ”¹è·¯ç”±è¡¨ä¹‹å‰å·²ç»å®Œå…¨å¯åŠ¨å’Œæ¿€æ´»ã€‚è¿™æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå¦‚æœåœ¨ç½‘ç»œæ¥å£è¿˜æ²¡æœ‰æ¿€æ´»çš„æƒ…å†µä¸‹å°è¯•è®¾ç½®è·¯ç”±ï¼Œå¯èƒ½ä¼šå¯¼è‡´å‘½ä»¤å¤±è´¥ã€‚\n[Service]éƒ¨åˆ†ï¼š Type=oneshot: è¿™æ„å‘³ç€è¿™ä¸ªæœåŠ¡åœ¨å¯åŠ¨æ—¶è¿è¡Œä¸€æ¬¡ç„¶åç»“æŸï¼Œä¸ä¼šæŒç»­è¿è¡Œã€‚ ExecStartPre: è¿™æ˜¯åœ¨ä¸»å‘½ä»¤ï¼ˆExecStartï¼‰æ‰§è¡Œä¹‹å‰è¿è¡Œçš„å‘½ä»¤ã€‚å®ƒçš„ä½œç”¨æ˜¯æ£€æŸ¥å½“å‰è·¯ç”±è¡¨ä¸­æ˜¯å¦å­˜åœ¨é»˜è®¤è·¯ç”±ï¼š /bin/sh -c 'ip route | grep -q default \u0026\u0026 ip route del default'ï¼šè¿™æ¡å‘½ä»¤ä¼šé¦–å…ˆæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨é»˜è®¤è·¯ç”±ï¼Œå¦‚æœå­˜åœ¨ï¼ˆgrep -q default è¿”å›0ï¼‰ï¼Œåˆ™æ‰§è¡Œåˆ é™¤é»˜è®¤è·¯ç”±çš„å‘½ä»¤ï¼ˆip route del defaultï¼‰ã€‚è¿™é‡Œä½¿ç”¨grep -qæ˜¯ä¸ºäº†é™é»˜æ¨¡å¼ï¼Œåªè¿”å›å­˜åœ¨ä¸å¦çš„çŠ¶æ€ç è€Œä¸è¾“å‡ºæ–‡æœ¬ã€‚ ExecStart: è¿™æ˜¯æœåŠ¡çš„ä¸»å‘½ä»¤ï¼Œç”¨äºæ·»åŠ æ–°çš„é»˜è®¤è·¯ç”±ã€‚å¦‚æœå‰é¢çš„é»˜è®¤è·¯ç”±å·²è¢«åˆ é™¤ï¼Œè¿™æ¡å‘½ä»¤ä¼šæ— éšœç¢åœ°è®¾ç½®æ–°çš„é»˜è®¤è·¯ç”±ã€‚ RemainAfterExit=yes: é€šå¸¸ç”¨äºType=oneshotçš„æœåŠ¡ï¼ŒæŒ‡ç¤ºå³ä½¿æœåŠ¡çš„ä¸»è¿›ç¨‹å·²ç»ç»“æŸï¼Œæ­¤æœåŠ¡çš„çŠ¶æ€ä¾æ—§è¢«è§†ä¸ºæ¿€æ´»ã€‚ è¿™ç§é…ç½®æ–¹å¼ï¼Œç‰¹åˆ«æ˜¯ExecStartPreå‘½ä»¤çš„ä½¿ç”¨ï¼Œæ˜¯ä¸ºäº†ç¡®ä¿ä¿®æ”¹é»˜è®¤è·¯ç”±æ—¶ä¸ä¼šå› ä¸ºæ—§çš„è·¯ç”±è®¾ç½®å­˜åœ¨è€Œå‡ºç°å†²çªæˆ–é”™è¯¯ã€‚é€šè¿‡è¿™æ ·çš„å®‰æ’ï¼ŒæœåŠ¡åœ¨æ‰§è¡Œä»»ä½•æ“ä½œä¹‹å‰ç¡®ä¿äº†ç½‘ç»œæ¥å£çš„å¯ç”¨æ€§å’Œæ¸…ç†äº†å¯èƒ½å­˜åœ¨çš„å†²çªé…ç½®ï¼Œä»è€Œä½¿å¾—é»˜è®¤ç½‘å…³çš„è®¾ç½®æ›´åŠ å¯é å’Œç¨³å®šã€‚\n",
  "wordCount" : "2296",
  "inLanguage": "zh",
  "datePublished": "2024-04-16T11:04:42+08:00",
  "dateModified": "2024-04-16T11:04:42+08:00",
  "author":[{
    "@type": "Person",
    "name": "CKYoung"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ahaknow.com/posts/know/linux-repair-routing-table/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "AhaKnow",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ahaknow.com/Q.gif"
    }
  }
}
</script>
    
    
    
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ahaknow.com/" accesskey="h" title="AhaKnow (Alt + H)">
                <img src="https://ahaknow.com/Q.gif" alt="" aria-label="logo"
                    height="35">AhaKnow</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ahaknow.com/search" title="ğŸª„é­”æ³• (Alt &#43; /)" accesskey=/>
                    <span>ğŸª„é­”æ³•</span>
                </a>
            </li>
            <li>
                <a href="https://ahaknow.com/" title="ğŸ¡ä¸»é¡µ">
                    <span>ğŸ¡ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://ahaknow.com/posts" title="ğŸš€å¤©å¤©å‘ä¸Š">
                    <span>ğŸš€å¤©å¤©å‘ä¸Š</span>
                </a>
            </li>
            <li>
                <a href="https://ahaknow.com/archives" title="â±ï¸æ—¶é—´çº¿">
                    <span>â±ï¸æ—¶é—´çº¿</span>
                </a>
            </li>
            <li>
                <a href="https://ahaknow.com/tags" title="ğŸ·ï¸æ ‡ç­¾">
                    <span>ğŸ·ï¸æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://ahaknow.com/categories" title="ğŸ–‡å½’æ¡£">
                    <span>ğŸ–‡å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://ahaknow.com/toolkits" title="ğŸ§°åŒ»ç–—ç®±">
                    <span>ğŸ§°åŒ»ç–—ç®±</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://ahaknow.com/">ğŸ¡ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://ahaknow.com/posts/">ğŸš€ å¤©å¤©å‘ä¸Š</a>&nbsp;Â»&nbsp;<a href="https://ahaknow.com/posts/know/">ğŸŒŸçŸ¥è¯†</a></div>
    <h1 class="post-title entry-hint-parent">
      Linuxï¼šä¸Šä¸äº†ç½‘äº†ä¹‹è·¯ç”±è¡¨ä¿®å¤
    </h1>
    <div class="post-description">
      è¿æ¥ä¸€ä¸ªç½‘å£è®¾å¤‡ï¼Œå¯¼è‡´ä¸Šä¸äº†ç½‘ï¼Œå’‹æ€ï¼Ÿ
    </div>
    <div class="post-meta">

























<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<span class="parent-post-meta">
        <span id="post_meta_style_1">
            <span class="fa fa-calendar-check-o"></span>
            <span>2024-04-16
                &nbsp;&nbsp;
            </span>
        </span>
        <span id="post_meta_style_2">
        <span class="fa fa-calendar-plus-o"></span>
        <span>2024-04-16
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>2296 å­—
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>5 åˆ†é’Ÿ
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>CKYoung
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="https://ahaknow.com/tags/%E8%B7%AF%E7%94%B1%E8%A1%A8/" style="color: var(--secondary)!important;">è·¯ç”±è¡¨</a>
            </span>
        </span>
    </span>
</span>

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ğŸ“šç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%85%88%e6%8a%8a%e9%97%ae%e9%a2%98%e8%a7%a3%e5%86%b3%e4%ba%86" aria-label="å…ˆæŠŠé—®é¢˜è§£å†³äº†">å…ˆæŠŠé—®é¢˜è§£å†³äº†</a><ul>
                        
                <li>
                    <a href="#%e5%8f%a6%e4%b8%80%e7%a7%8d%e6%80%9d%e8%b7%af" aria-label="å¦ä¸€ç§æ€è·¯">å¦ä¸€ç§æ€è·¯</a><ul>
                        
                <li>
                    <a href="#metric-%e7%9a%84%e5%90%ab%e4%b9%89%e5%92%8c%e4%bd%9c%e7%94%a8" aria-label="Metric çš„å«ä¹‰å’Œä½œç”¨">Metric çš„å«ä¹‰å’Œä½œç”¨</a></li>
                <li>
                    <a href="#metric-%e5%80%bc%e7%9a%84%e9%80%89%e6%8b%a9" aria-label="Metric å€¼çš„é€‰æ‹©">Metric å€¼çš„é€‰æ‹©</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e8%87%aa%e5%8a%a8%e5%8c%96%e7%9a%84%e4%b8%80%e5%8a%b3%e6%b0%b8%e9%80%b8" aria-label="è‡ªåŠ¨åŒ–çš„â€œä¸€åŠ³æ°¸é€¸â€">è‡ªåŠ¨åŒ–çš„â€œä¸€åŠ³æ°¸é€¸â€</a><ul>
                        
                <li>
                    <a href="#%e6%9c%8d%e5%8a%a1%e6%96%87%e4%bb%b6%e7%9a%84%e9%83%a8%e5%88%86%e8%a7%a3%e9%87%8a" aria-label="æœåŠ¡æ–‡ä»¶çš„éƒ¨åˆ†è§£é‡Š">æœåŠ¡æ–‡ä»¶çš„éƒ¨åˆ†è§£é‡Š</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
            const id = encodeURI(element.getAttribute('id')).toLowerCase();
            if (element === activeElement){
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
            } else {
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
            }
        })
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
  <div class="post-content"><blockquote>
<p><strong>é—®é¢˜æè¿°ï¼š</strong></p>
<p>LinuxåŒæ—¶è¿æ¥å±€åŸŸç½‘ï¼Œç½‘æ®µæ˜¯172.27.0.xï¼Œä»¥åŠè¿æ¥ç½‘å£çš„ç›¸æœºè®¾å¤‡ï¼Œç½‘æ®µæ˜¯192.168.80.xã€‚</p>
<p>Linuxå¯åŠ¨åå‡ºç°è¿™ç§æƒ…å†µï¼š</p>
<ul>
<li>å¯ä»¥è¿æ¥ç›¸æœºï¼Œä½†æ— æ³•ä¸Šç½‘</li>
<li>å°†ç›¸æœºçš„ç½‘çº¿æ‹”æ‰åï¼Œå°±èƒ½å¤Ÿä¸Šç½‘äº†</li>
</ul>
<p>ç®€å•çš„åˆ†æä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯ç½‘ç»œå ç”¨çš„é—®é¢˜ã€‚</p>
</blockquote>
<h2 id="å…ˆæŠŠé—®é¢˜è§£å†³äº†">å…ˆæŠŠé—®é¢˜è§£å†³äº†<a hidden class="anchor" aria-hidden="true" href="#å…ˆæŠŠé—®é¢˜è§£å†³äº†">#</a></h2>
<p><strong>ä¸‹é¢å…·ä½“æ¥åˆ†æ</strong></p>
<p>é€šè¿‡<code>route -n</code>æ¥æŸ¥çœ‹è·¯ç”±è¡¨ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ route -n
</span></span><span class="line"><span class="cl">Kernel IP routing table
</span></span><span class="line"><span class="cl">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
</span></span><span class="line"><span class="cl">0.0.0.0         192.168.80.1    0.0.0.0         UG    <span class="m">0</span>      <span class="m">0</span>        <span class="m">0</span> eno1
</span></span><span class="line"><span class="cl">0.0.0.0         172.27.0.1      0.0.0.0         UG    <span class="m">101</span>    <span class="m">0</span>        <span class="m">0</span> eno1
</span></span><span class="line"><span class="cl">169.254.0.0     0.0.0.0         255.255.0.0     U     <span class="m">1000</span>   <span class="m">0</span>        <span class="m">0</span> enx0826ae3c0c7b
</span></span><span class="line"><span class="cl">172.17.0.0      0.0.0.0         255.255.0.0     U     <span class="m">0</span>      <span class="m">0</span>        <span class="m">0</span> docker0
</span></span><span class="line"><span class="cl">172.27.0.0      0.0.0.0         255.255.255.0   U     <span class="m">101</span>    <span class="m">0</span>        <span class="m">0</span> eno1
</span></span><span class="line"><span class="cl">192.168.80.0    0.0.0.0         255.255.255.0   U     <span class="m">100</span>    <span class="m">0</span>        <span class="m">0</span> enx0826ae3c0c7b
</span></span></code></pre></div><p>å¯ä»¥çœ‹å‡ºæ¥æœ‰ä¸¤ä¸ªè®¾å¤‡ï¼Œä¸€ä¸ªæ˜¯<code>eno1</code>ï¼Œå±€åŸŸç½‘ç½‘çº¿ï¼Œå¦ä¸€ä¸ªæ˜¯<code>enx0826ae3c0c7b</code>ï¼Œç½‘å£çš„ç›¸æœºã€‚</p>
<p>ä¸ºå•¥ä¼šä¸Šä¸äº†ç½‘æï¼Ÿ</p>
<p><strong>è§‚å¯Ÿè¿™ä¸ªè·¯ç”±è¡¨çš„å¯ä»¥å‘ç°æœ‰ä¸€ä¸ªé‡å¤çš„æ··ä¹±é¡¹ï¼š</strong></p>
<p><code>Destination</code> ä¸º <code>0.0.0.0</code> ä½†æ˜¯ <code>Gateway</code> å´æœ‰ä¸¤ä¸ªï¼Œå°±æ˜¯è¿™é‡Œå¯¼è‡´çš„ï¼Œè¿™æ—¶å€™çš„è§£å†³æ–¹æ³•å°±æ˜¯ï¼Œå…ˆæ¸…é™¤é»˜è®¤è·¯ç”±ï¼Œç„¶åå†é…ç½®ä¸€ä¸ªæ­£ç¡®çš„é»˜è®¤è·¯ç”±ã€‚</p>
<p>æ­¥éª¤1ï¼šæ¸…é™¤é”™è¯¯çš„é»˜è®¤è·¯ç”±</p>
<p>é¦–å…ˆï¼Œåˆ é™¤æ‰€æœ‰é»˜è®¤è·¯ç”±ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo ip route del default
</span></span></code></pre></div><p>æ­¥éª¤2ï¼šæ·»åŠ æ­£ç¡®çš„é»˜è®¤è·¯ç”±</p>
<p>å°†é»˜è®¤è·¯ç”±è®¾ç½®ä¸ºé€šè¿‡ç½‘å…³`172.27.0.1ï¼Œå¹¶æŒ‡å®šåˆé€‚çš„åº¦é‡å€¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo ip route add default via 172.27.0.1 dev eno1 metric <span class="m">0</span>
</span></span></code></pre></div><p>æ­¥éª¤3ï¼šéªŒè¯è·¯ç”±è¡¨</p>
<p>å†æ¬¡æ£€æŸ¥è·¯ç”±è¡¨ï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œå¹¶ä¸”å…¶ä»–è·¯ç”±æŒ‰é¢„æœŸé…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">route -n
</span></span></code></pre></div><p>è¿™ä¸ªæ—¶å€™å¾—åˆ°çš„åº”è¯¥å°±æ˜¯æ­£ç¡®çš„è·¯ç”±è¡¨äº†ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â¯ route -n
</span></span><span class="line"><span class="cl">Kernel IP routing table
</span></span><span class="line"><span class="cl">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
</span></span><span class="line"><span class="cl">0.0.0.0         172.27.0.1      0.0.0.0         UG    <span class="m">0</span>      <span class="m">0</span>        <span class="m">0</span> eno1
</span></span><span class="line"><span class="cl">0.0.0.0         172.27.0.1      0.0.0.0         UG    <span class="m">101</span>    <span class="m">0</span>        <span class="m">0</span> eno1
</span></span><span class="line"><span class="cl">169.254.0.0     0.0.0.0         255.255.0.0     U     <span class="m">1000</span>   <span class="m">0</span>        <span class="m">0</span> enx0826ae3c0c7b
</span></span><span class="line"><span class="cl">172.17.0.0      0.0.0.0         255.255.0.0     U     <span class="m">0</span>      <span class="m">0</span>        <span class="m">0</span> docker0
</span></span><span class="line"><span class="cl">172.27.0.0      0.0.0.0         255.255.255.0   U     <span class="m">101</span>    <span class="m">0</span>        <span class="m">0</span> eno1
</span></span><span class="line"><span class="cl">192.168.80.0    0.0.0.0         255.255.255.0   U     <span class="m">100</span>    <span class="m">0</span>        <span class="m">0</span> enx0826ae3c0c7b
</span></span></code></pre></div><h3 id="å¦ä¸€ç§æ€è·¯">å¦ä¸€ç§æ€è·¯<a hidden class="anchor" aria-hidden="true" href="#å¦ä¸€ç§æ€è·¯">#</a></h3>
<p>åœ¨è·¯ç”±è¡¨ä¸­ï¼Œ<code>metric</code>å€¼ç”¨äºå®šä¹‰è·¯ç”±çš„ä¼˜å…ˆçº§ã€‚å½“å­˜åœ¨å¤šæ¡åˆ°è¾¾åŒä¸€ä¸ªç›®çš„åœ°çš„è·¯ç”±æ—¶ï¼Œ<code>metric</code>å€¼è¾ƒå°çš„è·¯ç”±å°†è¢«ä¼˜å…ˆé€‰æ‹©ç”¨äºæ•°æ®ä¼ è¾“ã€‚å› æ­¤ï¼Œ<code>metric</code>æ˜¯ä¸€ç§å†³å®šè·¯å¾„é€‰æ‹©çš„æ–¹æ³•ï¼Œå°¤å…¶åœ¨å¤šä¸ªç½‘ç»œæ¥å£å¯ç”¨æ—¶è¿™ä¸€ç‚¹éå¸¸é‡è¦ã€‚</p>
<h4 id="metric-çš„å«ä¹‰å’Œä½œç”¨">Metric çš„å«ä¹‰å’Œä½œç”¨<a hidden class="anchor" aria-hidden="true" href="#metric-çš„å«ä¹‰å’Œä½œç”¨">#</a></h4>
<ul>
<li><strong>å«ä¹‰</strong>ï¼š<code>metric</code>å€¼æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œç”¨äºè¡¨ç¤ºè·¯ç”±çš„ä¼˜å…ˆçº§ã€‚æ•°å­—è¶Šå°ï¼Œè¯¥è·¯ç”±çš„ä¼˜å…ˆçº§è¶Šé«˜ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼š
<ul>
<li><strong>é€‰æ‹©æœ€ä¼˜è·¯å¾„</strong>ï¼šåœ¨å¤šæ¡è·¯ç”±å¯è¾¾åŒä¸€ç›®çš„åœ°çš„æƒ…å†µä¸‹ï¼Œè·¯ç”±å™¨æ ¹æ®<code>metric</code>å€¼é€‰æ‹©<code>metric</code>æœ€å°çš„è·¯ç”±ä½œä¸ºæœ€ä½³è·¯å¾„ã€‚</li>
<li><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šåœ¨æŸäº›é…ç½®ä¸­ï¼Œå¯ä»¥æ•…æ„è®¾ç½®ç›¸åŒçš„<code>metric</code>å€¼ç»™ä¸åŒçš„è·¯ç”±ï¼Œä»¥å®ç°è´Ÿè½½å‡è¡¡ã€‚</li>
<li><strong>é¿å…è·¯ç”±å¾ªç¯</strong>ï¼šé€‚å½“çš„<code>metric</code>å€¼é…ç½®å¯ä»¥å¸®åŠ©é¿å…è·¯ç”±å¾ªç¯ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤æ‚çš„ç½‘ç»œæ‹“æ‰‘ä¸­ã€‚</li>
</ul>
</li>
</ul>
<h4 id="metric-å€¼çš„é€‰æ‹©">Metric å€¼çš„é€‰æ‹©<a hidden class="anchor" aria-hidden="true" href="#metric-å€¼çš„é€‰æ‹©">#</a></h4>
<p>æ¯”å¦‚ï¼Œ<code>metric</code>å€¼ä¸º0, 101, 100, 1000ç­‰ï¼Œè¿™äº›éƒ½æ˜¯ç”¨æ¥åŒºåˆ†ä¸åŒè·¯ç”±æ¡ç›®çš„ç›¸å¯¹ä¼˜å…ˆçº§ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>Metric ä¸º 0</strong>ï¼šé€šå¸¸è¡¨ç¤ºè¯¥è·¯ç”±å…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œç³»ç»Ÿå°†ä¼˜å…ˆé€šè¿‡è¿™ä¸ªè·¯ç”±å‘é€æ•°æ®ã€‚</li>
<li><strong>Metric ä¸º 101 æˆ– 100</strong>ï¼šè¿™äº›å€¼è¾ƒé«˜ï¼Œè¡¨ç¤ºè·¯ç”±çš„ä¼˜å…ˆçº§è¾ƒä½ã€‚å¦‚æœé»˜è®¤è·¯ç”±ï¼ˆmetric ä¸º 0 çš„è·¯ç”±ï¼‰ä¸å¯ç”¨ï¼Œç³»ç»Ÿå¯èƒ½ä¼šè€ƒè™‘ä½¿ç”¨è¿™äº›è·¯ç”±ã€‚</li>
<li><strong>Metric ä¸º 1000</strong>ï¼šæ›´é«˜çš„<code>metric</code>å€¼ï¼Œé€šå¸¸ç”¨äºå¤‡ä»½è·¯ç”±ï¼Œåªæœ‰åœ¨å…¶ä»–è¾ƒä½<code>metric</code>å€¼çš„è·¯ç”±å…¨éƒ½ä¸å¯ç”¨æ—¶ï¼Œæ‰ä¼šè¢«ä½¿ç”¨ã€‚</li>
</ul>
<p><mark>å› æ­¤ä¸Šè¿°çš„é—®é¢˜è¿˜å¯ä»¥é€šè¿‡æ›´æ”¹è·¯ç”±çš„ä¼˜å…ˆçº§æ¥è§£å†³</mark></p>
<hr>
<p><mark>ç°åœ¨é—®é¢˜è§£å†³äº†ï¼Œä½†æ˜¯è§£å†³äº†ä¸€æ—¶ï¼Œè§£å†³ä¸äº†ä¸€ä¸–ï¼Œå¦‚æœLinuxä¸»æœºé‡æ–°å¯åŠ¨ï¼Œé‚£ä¹ˆåˆä¼šæ¢å¤ä¸ºåŸæ¥çš„è®¾ç½®ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</mark></p>
<p><strong>é‚£å°±è®¾ç½®ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„å¯åŠ¨é¡¹ï¼</strong></p>
<h2 id="è‡ªåŠ¨åŒ–çš„ä¸€åŠ³æ°¸é€¸">è‡ªåŠ¨åŒ–çš„â€œä¸€åŠ³æ°¸é€¸â€<a hidden class="anchor" aria-hidden="true" href="#è‡ªåŠ¨åŒ–çš„ä¸€åŠ³æ°¸é€¸">#</a></h2>
<p>åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„<code>systemd</code>æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´<code>systemd</code>æœåŠ¡æ¥ç¡®ä¿åœ¨æ‰§è¡Œè·¯ç”±åˆ é™¤å’Œæ·»åŠ æ“ä½œä¹‹å‰ï¼Œç½‘ç»œæ¥å£å·²ç»æ­£ç¡®åˆå§‹åŒ–ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥åŠ å…¥æ¡ä»¶åˆ¤æ–­ï¼Œåªåœ¨é»˜è®¤è·¯ç”±å­˜åœ¨æ—¶å°è¯•åˆ é™¤å®ƒã€‚</p>
<ol>
<li>
<p><strong>ä¿®æ”¹ Systemd æœåŠ¡æ–‡ä»¶</strong>ï¼š
ç¼–è¾‘ä¹‹å‰åˆ›å»ºçš„<code>systemd</code>æœåŠ¡æ–‡ä»¶ï¼Œæ·»åŠ æ¡ä»¶åˆ¤æ–­å’Œä¾èµ–å…³ç³»ï¼Œç¡®ä¿åœ¨æ‰§è¡Œè·¯ç”±æ“ä½œå‰ç½‘ç»œæ¥å£å·²å‡†å¤‡å¥½ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo vim /etc/systemd/system/setdefaultgateway.service
</span></span></code></pre></div><p>ä¿®æ”¹æœåŠ¡æ–‡ä»¶ï¼ŒåŠ å…¥ç½‘ç»œåœ¨çº¿çš„æ¡ä»¶å’Œæ‰§è¡Œå‘½ä»¤å‰çš„æ£€æŸ¥ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">[Unit]
</span></span><span class="line"><span class="cl">Description=Set default gateway
</span></span><span class="line"><span class="cl">Wants=network-online.target
</span></span><span class="line"><span class="cl">After=network-online.target
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[Service]
</span></span><span class="line"><span class="cl">Type=oneshot
</span></span><span class="line"><span class="cl">ExecStartPre=/bin/sh -c &#39;ip route | grep -q default &amp;&amp; ip route del default&#39;
</span></span><span class="line"><span class="cl">ExecStart=/sbin/ip route add default via 172.27.0.1 dev eno1 metric 0
</span></span><span class="line"><span class="cl">RemainAfterExit=yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[Install]
</span></span><span class="line"><span class="cl">WantedBy=multi-user.target
</span></span></code></pre></div><p>è¿™é‡Œ<code>ExecStartPre</code>è¡Œç”¨äºæ£€æŸ¥æ˜¯å¦å­˜åœ¨é»˜è®¤è·¯ç”±ï¼Œå¹¶ä¸”åªæœ‰åœ¨å­˜åœ¨çš„æƒ…å†µä¸‹æ‰å°è¯•åˆ é™¤å®ƒã€‚è¿™æ ·å¯ä»¥é¿å…å› ä¸ºå°è¯•åˆ é™¤ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯ç”±è€Œå¯¼è‡´æœåŠ¡å¤±è´¥ã€‚</p>
</li>
<li>
<p><strong>é‡æ–°åŠ è½½å’Œå¯åŠ¨æœåŠ¡</strong>ï¼š
åŠ è½½æ–°çš„é…ç½®å¹¶é‡æ–°å¯åŠ¨æœåŠ¡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo systemctl daemon-reload
</span></span><span class="line"><span class="cl">sudo systemctl restart setdefaultgateway
</span></span></code></pre></div></li>
<li>
<p><strong>æ£€æŸ¥æœåŠ¡çŠ¶æ€</strong>ï¼š
ç¡®ä¿æœåŠ¡ç°åœ¨èƒ½å¤ŸæˆåŠŸæ‰§è¡Œï¼Œä¸å†æŠ¥é”™ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo systemctl status setdefaultgateway
</span></span></code></pre></div></li>
</ol>
<p>é€šè¿‡ç¡®ä¿åœ¨ç½‘ç»œæ¥å£å‡†å¤‡å¥½åæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”åªåœ¨é»˜è®¤è·¯ç”±å­˜åœ¨æ—¶å°è¯•åˆ é™¤å®ƒï¼Œèƒ½å¤Ÿé¿å…æœåŠ¡å¯åŠ¨æ—¶é‡åˆ°çš„â€œRTNETLINK answers: No such processâ€é”™è¯¯ã€‚</p>
<h3 id="æœåŠ¡æ–‡ä»¶çš„éƒ¨åˆ†è§£é‡Š">æœåŠ¡æ–‡ä»¶çš„éƒ¨åˆ†è§£é‡Š<a hidden class="anchor" aria-hidden="true" href="#æœåŠ¡æ–‡ä»¶çš„éƒ¨åˆ†è§£é‡Š">#</a></h3>
<ol>
<li><strong>[Unit]éƒ¨åˆ†</strong>ï¼š
<ul>
<li><code>Description</code>: ä»…ä¸ºæ­¤æœåŠ¡æä¾›æè¿°ï¼Œè¯´æ˜å…¶ç”¨é€”ã€‚</li>
<li><code>Wants</code>: è¿™ä¸€è¡ŒæŒ‡å®šäº†æ­¤æœåŠ¡æƒ³è¦çš„å…¶ä»–å•ä½ï¼ˆunitï¼‰ã€‚<code>network-online.target</code>æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç›®æ ‡ï¼Œä»£è¡¨ç½‘ç»œé…ç½®å·²å®Œå…¨å®Œæˆä¸”äº’è”ç½‘è¿æ¥å·²å»ºç«‹ã€‚</li>
<li><code>After</code>: è¿™ä¸€è¡Œç¡®ä¿äº†åœ¨<code>network-online.target</code>ä¹‹åæ‰å¯åŠ¨è¿™ä¸ªæœåŠ¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰åœ¨ç½‘ç»œç¡®å®å¯ç”¨ä¹‹åï¼Œæ­¤æœåŠ¡æ‰ä¼šè¿è¡Œå…¶å‘½ä»¤ã€‚</li>
</ul>
</li>
</ol>
<p>è¿™ä¸¤ä¸ªè®¾ç½®ï¼ˆ<code>Wants</code>å’Œ<code>After</code>ï¼‰ç¡®ä¿äº†ç½‘ç»œæœåŠ¡åœ¨å°è¯•ä¿®æ”¹è·¯ç”±è¡¨ä¹‹å‰å·²ç»å®Œå…¨å¯åŠ¨å’Œæ¿€æ´»ã€‚è¿™æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå¦‚æœåœ¨ç½‘ç»œæ¥å£è¿˜æ²¡æœ‰æ¿€æ´»çš„æƒ…å†µä¸‹å°è¯•è®¾ç½®è·¯ç”±ï¼Œå¯èƒ½ä¼šå¯¼è‡´å‘½ä»¤å¤±è´¥ã€‚</p>
<ol start="2">
<li><strong>[Service]éƒ¨åˆ†</strong>ï¼š
<ul>
<li><code>Type=oneshot</code>: è¿™æ„å‘³ç€è¿™ä¸ªæœåŠ¡åœ¨å¯åŠ¨æ—¶è¿è¡Œä¸€æ¬¡ç„¶åç»“æŸï¼Œä¸ä¼šæŒç»­è¿è¡Œã€‚</li>
<li><code>ExecStartPre</code>: è¿™æ˜¯åœ¨ä¸»å‘½ä»¤ï¼ˆ<code>ExecStart</code>ï¼‰æ‰§è¡Œä¹‹å‰è¿è¡Œçš„å‘½ä»¤ã€‚å®ƒçš„ä½œç”¨æ˜¯æ£€æŸ¥å½“å‰è·¯ç”±è¡¨ä¸­æ˜¯å¦å­˜åœ¨é»˜è®¤è·¯ç”±ï¼š
<ul>
<li><code>/bin/sh -c 'ip route | grep -q default &amp;&amp; ip route del default'</code>ï¼šè¿™æ¡å‘½ä»¤ä¼šé¦–å…ˆæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨é»˜è®¤è·¯ç”±ï¼Œå¦‚æœå­˜åœ¨ï¼ˆ<code>grep -q default</code> è¿”å›0ï¼‰ï¼Œåˆ™æ‰§è¡Œåˆ é™¤é»˜è®¤è·¯ç”±çš„å‘½ä»¤ï¼ˆ<code>ip route del default</code>ï¼‰ã€‚è¿™é‡Œä½¿ç”¨<code>grep -q</code>æ˜¯ä¸ºäº†é™é»˜æ¨¡å¼ï¼Œåªè¿”å›å­˜åœ¨ä¸å¦çš„çŠ¶æ€ç è€Œä¸è¾“å‡ºæ–‡æœ¬ã€‚</li>
</ul>
</li>
<li><code>ExecStart</code>: è¿™æ˜¯æœåŠ¡çš„ä¸»å‘½ä»¤ï¼Œç”¨äºæ·»åŠ æ–°çš„é»˜è®¤è·¯ç”±ã€‚å¦‚æœå‰é¢çš„é»˜è®¤è·¯ç”±å·²è¢«åˆ é™¤ï¼Œè¿™æ¡å‘½ä»¤ä¼šæ— éšœç¢åœ°è®¾ç½®æ–°çš„é»˜è®¤è·¯ç”±ã€‚</li>
<li><code>RemainAfterExit=yes</code>: é€šå¸¸ç”¨äº<code>Type=oneshot</code>çš„æœåŠ¡ï¼ŒæŒ‡ç¤ºå³ä½¿æœåŠ¡çš„ä¸»è¿›ç¨‹å·²ç»ç»“æŸï¼Œæ­¤æœåŠ¡çš„çŠ¶æ€ä¾æ—§è¢«è§†ä¸ºæ¿€æ´»ã€‚</li>
</ul>
</li>
</ol>
<p>è¿™ç§é…ç½®æ–¹å¼ï¼Œç‰¹åˆ«æ˜¯<code>ExecStartPre</code>å‘½ä»¤çš„ä½¿ç”¨ï¼Œæ˜¯ä¸ºäº†ç¡®ä¿ä¿®æ”¹é»˜è®¤è·¯ç”±æ—¶ä¸ä¼šå› ä¸ºæ—§çš„è·¯ç”±è®¾ç½®å­˜åœ¨è€Œå‡ºç°å†²çªæˆ–é”™è¯¯ã€‚é€šè¿‡è¿™æ ·çš„å®‰æ’ï¼ŒæœåŠ¡åœ¨æ‰§è¡Œä»»ä½•æ“ä½œä¹‹å‰ç¡®ä¿äº†ç½‘ç»œæ¥å£çš„å¯ç”¨æ€§å’Œæ¸…ç†äº†å¯èƒ½å­˜åœ¨çš„å†²çªé…ç½®ï¼Œä»è€Œä½¿å¾—é»˜è®¤ç½‘å…³çš„è®¾ç½®æ›´åŠ å¯é å’Œç¨³å®šã€‚</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ahaknow.com/tags/%E8%B7%AF%E7%94%B1%E8%A1%A8/">è·¯ç”±è¡¨</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://ahaknow.com/posts/know/note-git-branch-basic/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>Gitï¼šåˆ†æ”¯çš„åŸºæœ¬æ“ä½œ</span>
  </a>
  <a class="next" href="https://ahaknow.com/posts/know/leetcode-189-rotate-array/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>Leetcodeï¼š189. è½®è½¬æ•°ç»„</span>
  </a>
</nav>

  </footer>
</article>
</main>

<footer class="footer">
    <span>&copy; 2024 <a href="https://ahaknow.com/">AhaKnow</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/IHKYoung/CKPaper/" rel="noopener" target="_blank">CKPaper</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'ğŸ–¨ï¸æ‰“å°';

        function copyingDone() {
            copybutton.innerHTML = 'ğŸ“‹å¤‡ä»½';
            setTimeout(() => {
                copybutton.innerHTML = 'ğŸ–¨ï¸æ‰“å°';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                
                
                let copyText = codeblock.textContent + '\r\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' + 'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"AhaKnow"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' + '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                navigator.clipboard.writeText(copyText);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        document.querySelectorAll('pre > code[class*="language-"]').forEach(function(codeblock) {
            
            
            let language = codeblock.className.match(/language-(\w+)/)[1] || "code";

            
            let macCodeBlock = document.createElement("div");
            let macButtons = document.createElement("div");
            let buttons = ['close', 'minimize', 'maximize'].map(function(className) {
                let button = document.createElement("div");
                button.setAttribute('class', `mac-button ${className}`);
                return button;
            });
            let languageType = document.createElement("div");
            languageType.innerText = language;
            languageType.setAttribute('class', 'language-type');

            
            macButtons.setAttribute('class', 'mac-buttons');
            buttons.forEach(function(button) {
                macButtons.appendChild(button);
            });
            macCodeBlock.appendChild(macButtons);
            macCodeBlock.appendChild(languageType);
            macCodeBlock.setAttribute('class', 'mac-code-block');

            
            codeblock.parentNode.insertBefore(macCodeBlock, codeblock);
        });
    });
</script>


</body>

</html>
